library(washr)
setup_rawdata()
library(washr)
devtools::build_readme()
devtools::document()
devtools::check()
devtools::install()
setup_website()
# Required Libraries
library(tidyverse)
library(leaflet)
# Clean and prepare the data
df_clean <- floodresponsemw %>%
# Filter out records missing coordinates
filter(!is.na(latitude), !is.na(longitude)) %>%
# Assign colors based on functional status
mutate(
status_color = case_when(
functional_status == "Functional" ~ "green",
functional_status == "Not functional" ~ "red",
TRUE ~ "gray"  # Unknown or missing status
)
)
# Create an interactive map using leaflet
leaflet(df_clean) %>%
addTiles() %>%  # Add default OpenStreetMap tiles
addCircleMarkers(
lng = ~longitude,
lat = ~latitude,
color = ~status_color,  # Color by functional status
radius = ~log(total_users_of_water_point + 1) * 2,
stroke = FALSE,
fillOpacity = 0.7,
# Add popups showing basic water point info
popup = ~paste0(
"<b>Water Point:</b> ", water_point_name, "<br>",
"<b>Status:</b> ", functional_status, "<br>",
"<b>Total Users:</b> ", total_users_of_water_point
)
) %>%
# Add a legend for functional status
addLegend(
"bottomright",
colors = c("green", "red", "gray"),
labels = c("Functional", "Not Functional", "Unknown"),
title = "Water Point Status"
)
devtools::document()
devtools::check()
devtools::install()
library(washr)
setup_readme()
devtools::build_readme()
devtools::build_readme()
setup_website()
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%",
message = FALSE,
warning = FALSE,
fig.retina = 2,
fig.align = 'center'
)
## Run the following code in console if you don't have the packages
## install.packages(c("dplyr", "knitr", "readr", "stringr", "gt", "kableExtra"))
library(dplyr)
library(knitr)
library(readr)
library(stringr)
library(gt)
library(kableExtra)
extdata_path <- "https://github.com/openwashdata/floodresponsemw/raw/main/inst/extdata/"
read_csv("data-raw/dictionary.csv") |>
distinct(file_name) |>
dplyr::mutate(file_name = str_remove(file_name, ".rda")) |>
dplyr::rename(dataset = file_name) |>
mutate(
CSV = paste0("[Download CSV](", extdata_path, dataset, ".csv)"),
XLSX = paste0("[Download XLSX](", extdata_path, dataset, ".xlsx)")
) |>
knitr::kable()
library(floodresponsemw)
floodresponsemw |>
head(3) |>
gt::gt() |>
gt::as_raw_html()
readr::read_csv("data-raw/dictionary.csv") |>
dplyr::filter(file_name == "floodresponsemw.rda") |>
dplyr::select(variable_name:description) |>
knitr::kable() |>
kableExtra::kable_styling("striped") |>
kableExtra::scroll_box(height = "200px")
library(floodresponsemw)
# Required Libraries
library(tidyverse)
library(leaflet)
# Visualization 1: Interactive Water Point Map
# View the spatial distribution, functionality, and usage volume of water points.
# Clean and prepare the data
df_clean <- floodresponsemw %>%
# Filter out records missing coordinates
filter(!is.na(latitude), !is.na(longitude)) %>%
# Assign colors based on functional status
mutate(
status_color = case_when(
functional_status == "Functional" ~ "green",
functional_status == "Not functional" ~ "red",
TRUE ~ "gray"  # Unknown or missing status
)
)
# Create an interactive map using leaflet
leaflet(df_clean) %>%
addTiles() %>%  # Add default OpenStreetMap tiles
addCircleMarkers(
lng = ~longitude,
lat = ~latitude,
color = ~status_color,  # Color by functional status
radius = ~log(total_users_of_water_point + 1) * 2,
stroke = FALSE,
fillOpacity = 0.7,
# Add popups showing basic water point info
popup = ~paste0(
"<b>Water Point:</b> ", water_point_name, "<br>",
"<b>Status:</b> ", functional_status, "<br>",
"<b>Total Users:</b> ", total_users_of_water_point
)
) %>%
# Add a legend for functional status
addLegend(
"bottomright",
colors = c("green", "red", "gray"),
labels = c("Functional", "Not Functional", "Unknown"),
title = "Water Point Status"
)
# Visualization 2: Flood Impact Map
# visually assess how flooding has potentially affected water points
# Add a flood-related color column based on survey results
df_flood <- floodresponsemw %>%
mutate(
flood_color = case_when(
likely_submerged_during_flood == "Yes" ~ "blue",
likely_submerged_during_flood == "No" ~ "orange",
TRUE ~ "lightgray"  # For NA or uncertain responses
)
)
# Create a leaflet map for flood impact
leaflet(df_flood) %>%
addTiles() %>%  # Use OpenStreetMap base layer
addCircleMarkers(
lng = ~longitude,
lat = ~latitude,
color = ~flood_color,  # Color by flood status
radius = 6,
stroke = FALSE,
fillOpacity = 0.7,
# Add popups with flood-related details
popup = ~paste0(
"<b>Water Point:</b> ", water_point_name, "<br>",
"<b>Likely Submerged?:</b> ", likely_submerged_during_flood, "<br>",
"<b>Evidence Submerged:</b> ", evidence_submerged, "<br>",
"<b>Evidence Not Submerged:</b> ", evidence_not_submerged, "<br>",
"<b>Functional Status:</b> ", functional_status
)
) %>%
# Add legend explaining the color codes for flooding
addLegend(
"bottomright",
colors = c("blue", "orange", "lightgray"),
labels = c("Yes", "No", "Unknown"),
title = "Submerged During Flood?"
)
devtools::document()
devtools::check()
devtools::install()
pkgdown::build_site()
